<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Conversor Inteligente | PDF a Word</title>
  <meta name="description" content="Convierte tus archivos PDF a Word en segundos. Rápido, gratis y seguro.">
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

</head>
<body class="font-mono min-h-screen flex flex-col justify-between transition-colors duration-300 bg-gray-900 text-white" id="bodyElement">


<!-- Botón simple para cambiar el tema -->
<div class="absolute top-4 right-4">
  <button 
    id="botonTema"
    onclick="cambiartema()"
    class="px-4 py-2 rounded text-white bg-red-600 hover:bg-red-700 transition-colors duration-300"
  >
    Cambiar tema
  </button>
</div>



  <!-- Encabezado -->
  <header class="bg-gray-950 shadow-md py-4">
    <div class="max-w-5xl mx-auto px-4 flex justify-between items-center">
      <h1 class="tema-text text-2xl font-extrabold text-purple-400 tracking-wide">PFD a WOR</h1>
<nav class="flex space-x-4 text-sm font-mono uppercase">
<a href="#" class="tema-text-menu">Inicio</a>
<a href="#herramientas" class="tema-text-menu">Herramientas</a>
<a href="#contacto" class="tema-text-menu">Contacto</a>

</nav>

    </div>
  </header>

  <!-- Cuerpo principal -->
  <main class="max-w-3xl mx-auto mt-10 p-6 flex-grow">
    <div class="tema-bg bg-gradient-to-r from-gray-800 via-purple-900 to-violet-700 p-8 rounded-2xl shadow-xl">
      <h2 class="text-4xl font-bold text-center mb-4">Convertí tu PDF a Word</h2>
      <p class="text-center to-violet-700 mb-6 text-sm">Subí un archivo y descargalo convertido, sin marcas de agua.</p>

      <div id="drop-area" class="bg-white/10 border-2 border-dashed border-white/30 rounded-lg p-6 text-center mb-4 transition hover:border-purple-400">
        <p class="mb-2">Arrastrá un archivo aquí o hacé clic para seleccionarlo</p>
        <input type="file" id="fileInput" class="hidden" />
        <button onclick="document.getElementById('fileInput').click()" class="bg-purple-600 hover:bg-purple-800 px-4 py-2 rounded text-white">Seleccionar archivo</button>
        <p id="fileName" class="text-xs mt-2 text-purple-200"></p>
      </div>

      <div class="w-full h-2 bg-white/10 rounded overflow-hidden mb-4">
        <div id="progressBar" class="h-full bg-purple-500 animate-pulse transition-all duration-500" style="width: 0%"></div>
      </div>

      <button onclick="convertir()" class="tema-btn bg-purple-600 hover:bg-purple-800 py-3 px-6 w-full rounded text-lg transition">Convertir ahora</button>

      <p id="statusMsg" class="text-center mt-4 text-sm"></p>

      <div id="descargar" class="hidden mt-4 text-center">
        <a href="#" class="bg-green-600 hover:bg-green-800 text-white px-4 py-2 rounded">Descargar archivo convertido</a>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-950 text-purple-300 text-center text-xs py-6 mt-10">
    <p>&copy; 2025 Conversor Inteligente</p>
    <div class="mt-1">
      <a href="#" class="underline hover:text-purple-100">Política de privacidad</a> ·
      <a href="#" class="underline hover:text-purple-100">Términos y condiciones</a>
    </div>
  </footer>

  <script>
    const dropArea = document.getElementById('drop-area');
    const fileInput = document.getElementById('fileInput');
    const fileNameDisplay = document.getElementById('fileName');
    const progressBar = document.getElementById('progressBar');
    const statusMsg = document.getElementById('statusMsg');
    const descargar = document.getElementById('descargar');
    const API_KEY = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNGE0ZTFiNjE5YjUxYWY1ZDExMTNjNmY5YmFlNWNiNTNhMDYzNjA3NWFkMGE1NzJiYjQwOGQ2NmE0ODEwNjY5MDQ2YzRmMDdiNmM3YWYzOGEiLCJpYXQiOjE3NTQzNjM4NzYuMDQ0NjM2LCJuYmYiOjE3NTQzNjM4NzYuMDQ0NjM3LCJleHAiOjQ5MTAwMzc0NzYuMDM4MzQ0LCJzdWIiOiI3MjU4ODU0OSIsInNjb3BlcyI6WyJ0YXNrLnJlYWQiLCJ0YXNrLndyaXRlIl19.PoxCTS_2Y_i76dFqsnV-FzYnwy8tyamw12Habdq_8i27WIp9CIpI52LNEN85o9ZbRAUm0k-soxk6dfUuu09MV8qCW1uqLJ1ZV61EJhUqQAPftegMmZ-KQ7CebyrCPVLIr5GOgdR3lfiMUp7dFfZT_ogD1Ypy94PxtqPIRPIrLTz7aMIsoZDAODpgRKCGTt4Osx8snAjAHThQRVuAOVIsHgkk4QSP8YLdiurx2zEpoOTipg1fS7lnaZeunrV3icHOmnWPqo3VdM9YSxp52n0G6NC7SGlErrmmpZQu1oJnOQ8NjB6yidMqxvyBSqZlg4meleFir_dygjOz106UPh-QpncVQmdMLbMJxqVx9M43qzrDN8k3i_gWj9-OvjWXPRmI_D1pLpsMI5hLRq9PY_MgNCUxvT5o9zd4bJ4R7reAtF9AtAkXxm_t3ZmNN0WW9HOU7NWG0Xu4_mhXAHGUNE55EMbOLdmdP6h75zqSs7Sz2BZ2nucvbOCj8N43-QQG3vCkxvPdb3EtjvSCDeb-to-NxgmGK2pHn6kUkZ9wxp4MbY4HOWbKA0wufo35IMSMPT46NLyDleVTRstS2MAahfBO1zOBDjW49h_81HcWPPYsP-OrUPkwm9J4dBLjUAGXxWkenHBupoRBzvvtiOUxgIKaLpy8DOkD0WP8pAHk5YOBf-c';
//eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNGE0ZTFiNjE5YjUxYWY1ZDExMTNjNmY5YmFlNWNiNTNhMDYzNjA3NWFkMGE1NzJiYjQwOGQ2NmE0ODEwNjY5MDQ2YzRmMDdiNmM3YWYzOGEiLCJpYXQiOjE3NTQzNjM4NzYuMDQ0NjM2LCJuYmYiOjE3NTQzNjM4NzYuMDQ0NjM3LCJleHAiOjQ5MTAwMzc0NzYuMDM4MzQ0LCJzdWIiOiI3MjU4ODU0OSIsInNjb3BlcyI6WyJ0YXNrLnJlYWQiLCJ0YXNrLndyaXRlIl19.PoxCTS_2Y_i76dFqsnV-FzYnwy8tyamw12Habdq_8i27WIp9CIpI52LNEN85o9ZbRAUm0k-soxk6dfUuu09MV8qCW1uqLJ1ZV61EJhUqQAPftegMmZ-KQ7CebyrCPVLIr5GOgdR3lfiMUp7dFfZT_ogD1Ypy94PxtqPIRPIrLTz7aMIsoZDAODpgRKCGTt4Osx8snAjAHThQRVuAOVIsHgkk4QSP8YLdiurx2zEpoOTipg1fS7lnaZeunrV3icHOmnWPqo3VdM9YSxp52n0G6NC7SGlErrmmpZQu1oJnOQ8NjB6yidMqxvyBSqZlg4meleFir_dygjOz106UPh-QpncVQmdMLbMJxqVx9M43qzrDN8k3i_gWj9-OvjWXPRmI_D1pLpsMI5hLRq9PY_MgNCUxvT5o9zd4bJ4R7reAtF9AtAkXxm_t3ZmNN0WW9HOU7NWG0Xu4_mhXAHGUNE55EMbOLdmdP6h75zqSs7Sz2BZ2nucvbOCj8N43-QQG3vCkxvPdb3EtjvSCDeb-to-NxgmGK2pHn6kUkZ9wxp4MbY4HOWbKA0wufo35IMSMPT46NLyDleVTRstS2MAahfBO1zOBDjW49h_81HcWPPYsP-OrUPkwm9J4dBLjUAGXxWkenHBupoRBzvvtiOUxgIKaLpy8DOkD0WP8pAHk5YOBf-c


    dropArea.addEventListener('dragover', e => {
      e.preventDefault();
      dropArea.classList.add('border-purple-400');
    });

    dropArea.addEventListener('dragleave', () => {
      dropArea.classList.remove('border-purple-400');
    });

    dropArea.addEventListener('drop', e => {
      e.preventDefault();
      dropArea.classList.remove('border-purple-400');
      const file = e.dataTransfer.files[0];
      fileInput.files = e.dataTransfer.files;
      fileNameDisplay.textContent = 'Archivo seleccionado: ' + file.name;
    });

    fileInput.addEventListener('change', () => {
      const file = fileInput.files[0];
      fileNameDisplay.textContent = 'Archivo seleccionado: ' + file.name;
    });

async function convertir() {
  const file = fileInput.files[0];
  if (!file) {
    statusMsg.textContent = "Seleccioná un archivo primero.";
    return;
  }

  statusMsg.textContent = "Iniciando conversión...";
  progressBar.style.width = "20%";

  try {
    // Paso 1: obtener URL de subida
    const uploadRes = await fetch("https://api.cloudconvert.com/v2/import/upload", {
      method: "POST",
      headers: {
        Authorization: `Bearer ${API_KEY}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ filename: file.name })
    });

const uploadData = await uploadRes.json();

const importTaskId = uploadData.data.id;
const uploadUrl = uploadData.data.result.form.url;
const uploadParams = uploadData.data.result.form.parameters;


// Paso 2: subir el archivo con los parámetros que pide CloudConvert
const formData = new FormData();
Object.entries(uploadParams).forEach(([key, value]) => {
  formData.append(key, value);
});
formData.append("file", file);

await fetch(uploadUrl, {
  method: "POST",
  body: formData
});


    progressBar.style.width = "50%";
    statusMsg.textContent = "Archivo subido. Convirtiendo...";

    // Paso 3: crear job de conversión
    const jobRes = await fetch("https://api.cloudconvert.com/v2/jobs", {
      method: "POST",
      headers: {
        Authorization: `Bearer ${API_KEY}`,
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        tasks: {
          import_task: {
            operation: "import/upload",
            file: importTaskId
          },
          convert_task: {
            operation: "convert",
            input: "import_task",
            input_format: "pdf",
            output_format: "docx"
          },
          export_task: {
            operation: "export/url",
            input: "convert_task"
          }
        }
      })
    });

    const jobData = await jobRes.json();
    const jobId = jobData.data.id;

    // Paso 4: esperar a que termine la conversión
    let downloadUrl = null;
    while (!downloadUrl) {
      const check = await fetch(`https://api.cloudconvert.com/v2/jobs/${jobId}`, {
        headers: { Authorization: `Bearer ${API_KEY}` }
      });
      const jobStatus = await check.json();
      const exportTask = jobStatus.data.tasks.find(t => t.name === "export_task" && t.status === "finished");

      if (exportTask) {
        downloadUrl = exportTask.result.files[0].url;
        break;
      }

      await new Promise(resolve => setTimeout(resolve, 1500));
    }

    // Paso 5: mostrar link de descarga
    progressBar.style.width = "100%";
    statusMsg.textContent = "¡Conversión completada!";
    const link = descargar.querySelector("a");
    link.href = downloadUrl;
    link.download = "archivo_convertido.docx";
    descargar.classList.remove("hidden");
  } catch (error) {
    statusMsg.textContent = "Error en la conversión.";
    console.error(error);
  }
}


    //eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNGE0ZTFiNjE5YjUxYWY1ZDExMTNjNmY5YmFlNWNiNTNhMDYzNjA3NWFkMGE1NzJiYjQwOGQ2NmE0ODEwNjY5MDQ2YzRmMDdiNmM3YWYzOGEiLCJpYXQiOjE3NTQzNjM4NzYuMDQ0NjM2LCJuYmYiOjE3NTQzNjM4NzYuMDQ0NjM3LCJleHAiOjQ5MTAwMzc0NzYuMDM4MzQ0LCJzdWIiOiI3MjU4ODU0OSIsInNjb3BlcyI6WyJ0YXNrLnJlYWQiLCJ0YXNrLndyaXRlIl19.PoxCTS_2Y_i76dFqsnV-FzYnwy8tyamw12Habdq_8i27WIp9CIpI52LNEN85o9ZbRAUm0k-soxk6dfUuu09MV8qCW1uqLJ1ZV61EJhUqQAPftegMmZ-KQ7CebyrCPVLIr5GOgdR3lfiMUp7dFfZT_ogD1Ypy94PxtqPIRPIrLTz7aMIsoZDAODpgRKCGTt4Osx8snAjAHThQRVuAOVIsHgkk4QSP8YLdiurx2zEpoOTipg1fS7lnaZeunrV3icHOmnWPqo3VdM9YSxp52n0G6NC7SGlErrmmpZQu1oJnOQ8NjB6yidMqxvyBSqZlg4meleFir_dygjOz106UPh-QpncVQmdMLbMJxqVx9M43qzrDN8k3i_gWj9-OvjWXPRmI_D1pLpsMI5hLRq9PY_MgNCUxvT5o9zd4bJ4R7reAtF9AtAkXxm_t3ZmNN0WW9HOU7NWG0Xu4_mhXAHGUNE55EMbOLdmdP6h75zqSs7Sz2BZ2nucvbOCj8N43-QQG3vCkxvPdb3EtjvSCDeb-to-NxgmGK2pHn6kUkZ9wxp4MbY4HOWbKA0wufo35IMSMPT46NLyDleVTRstS2MAahfBO1zOBDjW49h_81HcWPPYsP-OrUPkwm9J4dBLjUAGXxWkenHBupoRBzvvtiOUxgIKaLpy8DOkD0WP8pAHk5YOBf-c


    
  function cambiartema() {
  const body = document.getElementById('bodyElement');
  const temaTextos = document.querySelectorAll('.tema-text');
  const temaTextosMenu = document.querySelectorAll('.tema-text-menu');
  const temaFondos = document.querySelectorAll('.tema-bg');
  const temaBotones = document.querySelectorAll('.tema-btn');
  const boton = document.getElementById('botonTema');

  const oscuro = body.classList.contains('bg-gray-900');

  body.classList.replace(oscuro ? 'bg-gray-900' : 'bg-white', oscuro ? 'bg-white' : 'bg-gray-900');
  body.classList.replace(oscuro ? 'text-white' : 'text-black', oscuro ? 'text-black' : 'text-white');

  temaTextos.forEach(el => {
    el.classList.replace(oscuro ? 'text-purple-400' : 'text-black', oscuro ? 'text-black' : 'text-purple-400');
  });

  temaTextosMenu.forEach(el => {
    el.classList.replace(oscuro ? 'text-purple-400' : 'text-black', oscuro ? 'text-black' : 'text-purple-400');
  });

  temaFondos.forEach(el => {
    el.classList.replace(oscuro ? 'from-gray-800' : 'from-gray-200', oscuro ? 'from-gray-200' : 'from-gray-800');
    el.classList.replace(oscuro ? 'via-purple-900' : 'via-purple-200', oscuro ? 'via-purple-200' : 'via-purple-900');
    el.classList.replace(oscuro ? 'to-violet-700' : 'to-violet-100', oscuro ? 'to-violet-100' : 'to-violet-700');
  });

  temaBotones.forEach(el => {
    el.classList.replace(oscuro ? 'bg-purple-600' : 'bg-blue-600', oscuro ? 'bg-blue-600' : 'bg-purple-600');
    el.classList.replace(oscuro ? 'text-white' : 'text-black', oscuro ? 'text-black' : 'text-white');
  });

  // Cambia el color del botón de rojo a verde y viceversa
  boton.classList.replace(oscuro ? 'bg-red-600' : 'bg-green-600', oscuro ? 'bg-green-600' : 'bg-red-600');
  boton.classList.replace(oscuro ? 'hover:bg-red-700' : 'hover:bg-green-700', oscuro ? 'hover:bg-green-700' : 'hover:bg-red-700');
}

  </script>



</body>
</html>
